{extend name="base/common"/}

{block name="header"}
{/block}

{block name="body"}
<script src="tpl_js/radialIndicator.js"></script>
<style>
canvas{ width:90px; height:90px; position:absolute; top:20px; left:0;}
</style>

<div class="publicdiv mt20 pt20 pb10 ptn sizing">
    <div class="publicdiv pl20 pr20 pt8 bf sizing">
        <div class="publicdiv borb mb20 pt10 pb10 bf sizing">
            <h3>项目列表</h3>
            <ul class="nav nav-pills">
                <li {if condition="$status == 'all'"} class="active" {/if}><a href="{:url('index/project/lists?status=all')}">所有</a></li>
                <li {if condition="$status == 'unclose'"} class="active" {/if}><a href="{:url('/index/project/lists?status=unclose')}">未关闭</a></li>
                <li {if condition="$status == 'delayed'"} class="active" {/if}><a href="{:url('/index/project/lists?status=delayed')}">已延期</a></li>
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">更多 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="{:url('index/project/lists?status=not')}">未开始</a></li>
                        <li><a href="{:url('index/project/lists?status=ing')}">进行中</a></li>
                        <li><a href="{:url('index/project/lists?status=done')}">已完成</a></li>
                        <li><a href="{:url('index/project/lists?status=closed')}">已关闭</a></li>
                    </ul>
                </li>
                <span class="pull-right">
                    <a href="{:url('add')}" class="btn btn-info">添加项目</a> 
                </span>
            </ul>
        </div>
    </div>
    
    <div class="publicdiv pr20 pb20 bf sizing">
        <ul class="projectlist">
            {foreach $project_list as $project}
            <li>
                {if condition="$project['status'] == 'wait'"}<div class="plwp bf_wait">{/if}
                {if condition="$project['status'] == 'done'"}<div class="plwp bf_done">{/if}
                {if condition="$project['status'] == 'doing'"}<div class="plwp bf_doing">{/if}
                {if condition="$project['status'] == 'closed'"}<div class="plwp bf_closed">{/if}
                    {if condition="$project['acl'] == 'private'"}<span class="plprivate iconfont">&#xe611;</span>{/if}
                    <a href="{:url('/index/project/add/?project_id='.$project['id'])}" title="编辑" class="plup iconfont">&#xe71d;</a>
                    <h3 class="pltitle"><a href="{:url('/index/project/detail/?id='.$project['id'])}" class="c0">{$project['name']}</a></h3>
                    <!--<div class="plprogress mt10">
                        <span style="width:{$project['percent']}%;" {if condition='$project["percent"] == 100'}class="bf100"{elseif condition='$project["percent"] > 50'}class="bf50"{/if}></span>
                    </div>-->
                    <a href="{:url('/index/project/detail/?id='.$project['id'])}">
                    <div class="publicdiv h120 pr c0" style="padding-left:110px;">
                        <div id="indicatorContainer_{$project['id']}"></div>
                        <p style="margin-top:35px;">负责人：{$project['project_admin']}</p>
                        <p>时间：{$project['end']}</p>
                    </div>
                    </a>
                    <a href="{:url('/index/project/detail/?id='.$project['id'])}">
                    <div class="publicdiv mt10 c0">
                        <p class="w33 z db ac mbn">{$project['all_time']}<br/><span>预计</span></p>
                        <p class="w33 z db ac mbn">{$project['estimate_count']}<br/><span>消耗</span></p>
                        <p class="w33 z db ac mbn">
                            {if condition="$project['status'] == 'wait'"}<span style="color:#f8b004;">等待</span>{/if}
                            {if condition="$project['status'] == 'done'"}<span style="color:green;">完成</span>{/if}
                            {if condition="$project['status'] == 'doing'"}<span style="color:blue;">进行中</span>{/if}
                            {if condition="$project['status'] == 'closed'"}<span style="color:grey;">关闭</span>{/if}
                        <br/><span>状态</span></p>
                    </div>
                    </a>
                </div>
            </li>
            <script>
            jQuery(document).ready(function() {  
                jQuery('#indicatorContainer_'+{$project['id']}).radialIndicator({
                    barColor: '#7cb5ec',
                    barWidth: 5,
                    initValue: {$project['percent']},
                    roundCorner : true,
                    percentage: true
                });
            });
            </script>
            {/foreach}
        </ul>
            
        <div class="publicdiv ac pagingw">{$page}</div>
    </div>
</div>
{/block}
