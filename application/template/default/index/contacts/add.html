{extend name="base/common"/}

{block name="header"}
{/block}

{block name="body"}
<div class="container" style="width:1170px;">
    <div class="publicdiv mt20 pl20 pr20 pt8 bf sizing">
        <div class="publicdiv mb20 ptlrb10 bf sizing">
            <form action="{:url('/index/contacts/add?id='.$contactData['id'])}" id="formaddress" enctype="multipart/form-data" method="post" class="form-horizontal" role="form" onkeydown="if(event.keyCode==13)return false;">
                <h3 class="ac borb pb30">
                    {if condition="$contactData['id'] > 0"}修改{else}添加{/if}联系人
                    <a href="{:url('/index/company/lists')}" class="btn btn-success y ml15">公司列表</a>
                </h3>
                <div class="modal-body">
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn">所属公司</label>
                        <div class="col-sm-7 pln prn">
                            <select class="form-control w60 z" name="company_id">
                                {foreach $companyList as $company}
                                <option value="{$company['company_id']}" {if condition="$contactData['company_id'] == $company['company_id']"}selected{/if}>{$company['name']}</option>
                                {/foreach}
                            </select>
                            <a href="javascript:void(0);" class="btn btn-primary z ml15">载入联系人</a>
                        </div>
                    </div>
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn"><b class="cred">* </b>姓名</label>
                        <div class="col-sm-7 pln prn">
                            <input type="text" name="name" class="form-control w60" id="name" onKeyup="pubinput('name');" placeholder="（必填）" value="{$contactData['name']}">
                            <p class="cred dn" id="name_prompt">请输入联系姓名</p>
                        </div>
                    </div>
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn"><b class="cred">* </b>联系电话</label>
                        <div class="col-sm-7 pln prn">
                            <input type="text" name="tel" class="form-control w60" id="tel" onKeyup="pubinput('tel');" placeholder="（必填）" value="{$contactData['tel']}">
                            <p class="cred dn" id="tel_prompt">请输入联系电话</p>
                        </div>
                    </div>
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn"><b class="cred">* </b>详细地址</label>
                        <div class="col-sm-7 pln prn">
                            <input type="text" name="address" class="form-control w90" id="address" onKeyup="pubinput('address');" placeholder="（必填）" value="{$contactData['address']}">
                            <p class="cred dn" id="address_prompt">请输入详细地址</p>
                        </div>
                    </div>
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn">&nbsp;</label>
                        <div class="col-sm-7 pln prn">
                            <a href="javascript:void(0);" class="iconfont" id="inputopen" title="展开更多" onClick="inputopen('addInputOpen');">展开更多 &#xe688;</a>
                        </div>
                    </div>
                    
                    <div class="publicdiv dn" id="addInputOpen">
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">职务</label>
                            <div class="col-sm-7 pln prn">
                                <input type="text" name="worktitle" class="form-control w60" id="worktitle" value="{$contactData['worktitle']}">
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">年龄</label>
                            <div class="col-sm-7 pln prn">
                                <input type="text" name="age" class="form-control w60" id="age" value="{$contactData['age']}">
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">性别</label>
                            <div class="col-sm-7 pln prn">
                                <label class="mt8 mr15"><input type="radio" name="sex" value="1" {if condition="$contactData['sex'] == 1"}checked{/if}> 男</label>
                                <label class="mt8"><input type="radio" name="sex" value="2" {if condition="$contactData['sex'] == 2"}checked{/if}> 女</label>
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">在职状态</label>
                            <div class="col-sm-7 pln prn">
                                <select class="form-control w30" name="status">
                                    <option value="0" {if condition="$contactData['status'] == 0"}selected{/if}>无</option>
                                    <option value="1" {if condition="$contactData['status'] == 1"}selected{/if}>在职</option>
                                    <option value="2" {if condition="$contactData['status'] == 2"}selected{/if}>离职</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">籍贯</label>
                            <div class="col-sm-7 pln prn">
                                <input type="text" name="native_place" class="form-control w60" id="native_place" value="{$contactData['native_place']}">
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">电子邮箱</label>
                            <div class="col-sm-7 pln prn">
                                <input type="text" name="mail" class="form-control w60" id="mail" value="{$contactData['mail']}">
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">照片</label>
                            <div class="col-sm-7 pln prn">
                                <div class="imgwrap" id="imgwrap">
                                    <input type="file" id="cover_image" class="cover" name="photo" value="{$contactData['photo']}" />
                                    <img src="{$contactData['photo']}" id="coverimg" />
                                </div>
                                <span id="original_img_ok">照片大小建议为700*700像素</span>
                                <span class="input_show_on" id="original_img_on">请选择个人照片</span>
                                <br/><span id="original_img_ok">支持格式：jpg,jpeg,png,gif,bmp</span>
                            </div>
                        </div>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">简介</label>
                            <div class="col-sm-7 pln prn">
                                <textarea class="w90 form-control" name="introduce" rows="4"></textarea>
                            </div>
                        </div>
                        
                        <script type="text/javascript" charset="utf-8" src="tpl_static/ueditor/ueditor.config.js"></script>
                        <script type="text/javascript" charset="utf-8" src="tpl_static/ueditor/ueditor.all.min.js"> </script>
                        <script type="text/javascript" charset="utf-8" src="tpl_static/ueditor/lang/zh-cn/zh-cn.js"></script>
                        
                        <div class="form-group w100 mrn mln z">
                            <label class="col-sm-2 control-label fwn">备注</label>
                            <div class="col-sm-10 pln prn">
                                <script id="editor" type="text/plain" class="z" name="remarks" style="width:100% !important; height:200px;">{$contactData['remarks']}</script>
                            </div>
                        </div>
                    </div>
                    
                    <script type="text/javascript">
                        //实例化编辑器
                        //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
                        var ue = UE.getEditor('editor',{toolbars: [['fullscreen', 'bold', 'source', 'undo', 'snapscreen', 'fontsize', 'redo', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', 'attachment']]});

                        function disableBtn(str) {
                            var div = document.getElementById('btns');
                            var btns = UE.dom.domUtils.getElementsByTagName(div, "button");
                            for (var i = 0, btn; btn = btns[i++];) {
                                if (btn.id == str) {
                                    UE.dom.domUtils.removeAttributes(btn, ["disabled"]);
                                } else {
                                    btn.setAttribute("disabled", "true");
                                }
                            }
                        }
                        function enableBtn() {
                            var div = document.getElementById('btns');
                            var btns = UE.dom.domUtils.getElementsByTagName(div, "button");
                            for (var i = 0, btn; btn = btns[i++];) {
                                UE.dom.domUtils.removeAttributes(btn, ["disabled"]);
                            }
                        }
                    </script>
                    
                    
                    <div class="form-group w100 mrn mln z">
                        <label class="col-sm-2 control-label fwn">&nbsp;</label>
                        <div class="col-sm-7 pln prn">
                            <input type="submit" class="btn btn-primary btn-lg pl20 pr20" onClick="contactsformsub();" value="完成" />
                        </div>
                    </div>
                    
                </div>
            </form>

        </div>
    </div>
</div>
<script>
jQuery(function () {
    if (jQuery('#coverimg').attr('src') == "") {    //封面为空则显示默认图片
        jQuery('#coverimg').attr('src', 'tpl_img/coverimg.png');
    }

    jQuery("#cover_image").change(function () {		//红包封面相册
        var objUr = getObjectURL(this.files[0]);
        console.log("objUr = " + objUr);
        jQuery("#coverimg").attr("src", objUr);
    });
});
//建立一個可存取到該file的url
function getObjectURL(file) {
    var url1 = null;
    if (window.createObjectURL != undefined) { // basic
        url1 = window.createObjectURL(file);
    } else if (window.URL != undefined) { // mozilla(firefox)
        url1 = window.URL.createObjectURL(file);
    } else if (window.webkitURL != undefined) { // webkit or chrome
        url1 = window.webkitURL.createObjectURL(file);
    }
    return url1;
}
</script>
{/block}